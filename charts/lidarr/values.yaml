# ==============================================================================
# Global configuration
# ==============================================================================
global:
  # -- Global image registry (used as fallback for all components)
  imageRegistry: ""
  # -- Global deployment strategy (used as fallback for all components)
  strategy:
    type: Recreate

# ==============================================================================
# Main Lidarr configuration
# ==============================================================================
image:
  # -- Image registry (falls back to global.imageRegistry, then to ghcr.io)
  registry: ""
  repository: home-operations/lidarr
  pullPolicy: IfNotPresent
  # -- Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# -- Deployment strategy (falls back to global.strategy)
strategy: {}

# -- Environment variables to add to the pods
extraEnv: []
# -- Environment variables from secrets or configmaps to add to the pods
extraEnvFrom: []

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext:
  fsGroup: 568
  fsGroupChangePolicy: OnRootMismatch

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 568
  runAsGroup: 568
  capabilities:
    drop:
      - ALL
  seccompProfile:
    type: RuntimeDefault

service:
  type: ClusterIP
  port: 80
  annotations: {}

ingress:
  enabled: false
  ingressClassName: ""
  annotations: {}
  hosts:
    - host: lidarr.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# -- Gateway API HTTPRoute
route:
  enabled: false
  parentRefs:
    - name: gateway
      namespace: gateway-system
  hostnames:
    - lidarr.local
  annotations: {}
  labels: {}

# -- Persistence configuration for /config
persistence:
  enabled: true
  size: 20Gi
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  existingClaim: ""
  annotations: {}

resources: {}

# -- Extra volumes (e.g., NFS for media)
volumes: []
# -- Extra volume mounts
volumeMounts: []

nodeSelector: {}
tolerations: []
affinity: {}

startupProbe:
  httpGet:
    path: /ping
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 5
  failureThreshold: 30

livenessProbe:
  httpGet:
    path: /ping
    port: http
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /ping
    port: http
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

# -- Monitoring configuration
monitoring:
  enabled: false
  # -- Type of service monitor: ServiceMonitor (Prometheus) or VMServiceScrape (VictoriaMetrics)
  type: ServiceMonitor
  path: /metrics
  interval: 30s
  scrapeTimeout: 10s
  labels: {}
  namespace: ""

# -- YouTube cookies for Tubifarry/yt-dlp
youtubeCookies:
  # -- Enable YouTube cookies mounting
  enabled: false
  # -- Path inside container where cookies file will be mounted
  mountPath: /config/youtube_cookies.txt
  # -- Use existing secret (must contain 'cookies.txt' key)
  existingSecret: ""
  # -- Cookies content (Netscape format, used if existingSecret is empty)
  # Get from browser extension like "Get cookies.txt LOCALLY"
  content: ""

# -- Extra init containers (e.g., for installing ffmpeg)
extraInitContainers: []
# Example for ffmpeg:
# - name: install-ffmpeg
#   image: alpine:3.21
#   command:
#     - sh
#     - -c
#     - |
#       if [ ! -f /config/ffmpeg/ffmpeg ]; then
#         apk add --no-cache ffmpeg
#         mkdir -p /config/ffmpeg
#         cp /usr/bin/ffmpeg /config/ffmpeg/
#         cp /usr/bin/ffprobe /config/ffmpeg/
#       fi
#   volumeMounts:
#     - name: config
#       mountPath: /config

# ==============================================================================
# Application configuration
# ==============================================================================
app:
  # -- Instance name shown in UI
  instanceName: "Lidarr"

  # -- Timezone (e.g., Europe/Moscow, UTC)
  timezone: "UTC"

  # -- Log level: debug, info, warn, error
  logLevel: "info"

  # -- Update branch: master, develop
  branch: "develop"

  # -- Analytics
  analyticsEnabled: false

  # -- Authentication configuration
  auth:
    # -- Authentication method: None, Basic, Forms, External
    method: "External"
    # -- When authentication is required: Enabled, DisabledForLocalAddresses
    required: "DisabledForLocalAddresses"
    # -- API key (auto-generated if empty and no existingSecret)
    apiKey: ""
    # -- Existing secret with API key
    existingSecret: ""
    # -- Key in the secret containing the API key
    apiKeyKey: "api-key"

  # -- Database configuration (PostgreSQL)
  database:
    # -- Database host (empty = use SQLite)
    host: ""
    port: 5432
    # -- Main database name
    name: "lidarr"
    # -- Logs database name
    logsName: "lidarr_logs"
    user: "lidarr"
    # -- Database password (required if host is set)
    password: ""
    # -- Existing secret with database password
    existingSecret: ""
    # -- Key in the secret containing the password
    passwordKey: "password"

  # -- Server configuration
  server:
    # -- Bind address (* for all interfaces)
    bindAddress: "*"
